<div class="property-form-container">
  <div class="back-button">
    <button type="button" class="btn btn-outline-secondary" routerLink="/inicio">
      <i class="bi bi-arrow-left"></i> Volver al Inicio
    </button>
  </div>

  <div class="form-header">
    <h1>Cuéntanos sobre tu inmueble</h1>
    <p>Completa la información para publicar tu propiedad</p>
  </div>

  <div class="form-steps">
    <div class="step active">1</div>
    <div class="step">2</div>
    <div class="step">3</div>
    <div class="step">4</div>
  </div>

  <form [formGroup]="registroInmuebleForm" (ngSubmit)="onSubmit()">

    <!-- Información básica -->
    <div class="form-section">
      <h3 class="section-title">Información básica</h3>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Tipo de negocio</label>
          <select class="form-select" formControlName="tipoNegocio" required>
            <option value="" disabled selected>Seleccionar</option>
            <option value="VENTA">Venta</option>
            <option value="ALQUILER">Alquiler</option>
            <option value="PERMUTACION">Permuta</option>
          </select>
        </div>

        <div class="col-md-6 mb-3">
          <label class="form-label">Tipo de inmueble</label>
          <select class="form-select" formControlName="tipo" required>
            <option value="" disabled selected>Seleccionar</option>
            <option value="CASA">Casa</option>
            <option value="APARTAMENTO">Apartamento</option>
            <option value="LOCAL">Local Comercial</option>
            <option value="LOTE">Lote</option>
            <option value="FINCA">Finca</option>
            <option value="OFICINA">Oficina</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Valor y estado -->
    <div class="form-section">
      <h3 class="section-title">Valor y estado</h3>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Precio</label>
          <div class="input-group">
            <span class="input-group-text">$</span>
            <input type="number" class="form-control" formControlName="precio" placeholder="Ej: 250000000">
          </div>
        </div>

      </div>

      <div class="mb-3">
        <label class="form-label">Estado del inmueble</label>
        <select class="form-select" formControlName="estado">
          <option value="" disabled selected>Seleccionar</option>
          <option value="NUEVO">Nuevo</option>
          <option value="USADO">Usado</option>
        </select>
      </div>
    </div>

    <!-- Espacios -->
    <div class="form-section">
      <h3 class="section-title">Espacios</h3>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label class="form-label">Nº Habitaciones</label>
          <select class="form-select" formControlName="habitaciones">
            <option *ngFor="let h of [0,1,2,3,4,5]" [value]="h">{{ h === 5 ? '5+' : h }}</option>
          </select>
        </div>

        <div class="col-md-4 mb-3">
          <label class="form-label">Nº Baños</label>
          <select class="form-select" formControlName="banos">
            <option *ngFor="let b of [0,1,2,3,4,5]" [value]="b">{{ b === 5 ? '5+' : b }}</option>
          </select>
        </div>

        <div class="col-md-4 mb-3">
          <label class="form-label">Nº Parqueaderos</label>
          <select class="form-select" formControlName="cantidadParqueaderos">
            <option *ngFor="let p of [0,1,2,3,4]" [value]="p">{{ p === 4 ? '4+' : p }}</option>
          </select>
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">Área construida (m²)</label>
        <input type="number" class="form-control" formControlName="medidas" placeholder="Ej: 120">
      </div>

      <div class="mb-3">
        <label class="form-label">Descripción</label>
        <textarea class="form-control" formControlName="descripcion" placeholder="Describe tu propiedad..."></textarea>
      </div>
    </div>

    <!-- Ubicación -->
    <div class="form-section">
      <h3 class="section-title">Ubicación</h3>
      <label class="form-label">Ubicación:</label>
      <div id="mapa"></div>
    </div>

    <!-- Imágenes -->
    <h3 class="section-title">Imágenes del inmueble</h3>
    <div class="image-upload" id="imageUpload"
         (click)="fileInput.click()"
         (dragover)="onDragOver($event)"
         (drop)="onDrop($event)">
      <div class="upload-icon">
        <i class="bi bi-cloud-arrow-up"></i>
      </div>
      <p>Haz clic o arrastra imágenes aquí para subirlas</p>
      <p class="text-muted">Máximo 10 imágenes (JPEG, PNG)</p>
      <input #fileInput type="file" multiple accept="image/jpeg,image/png" hidden (change)="onFileSelected($event)">
    </div>

    <div id="imagePreview" class="mt-3 row">
      <div class="col-md-3 mb-3" *ngFor="let img of imagenesPreview; let i = index">
        <div class="card">
          <img [src]="img" class="card-img-top" alt="Imagen {{ i + 1 }}">
          <div class="card-body text-center">
            <button class="btn btn-sm btn-danger" (click)="eliminarImagen(i)">Eliminar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Documentos PDF -->
    <h3 class="section-title">Documentos del inmueble (PDF)</h3>

    <div class="pdf-upload" id="pdfUpload"
         (click)="pdfInput.click()"
         (dragover)="onDragOverPDF($event)"
         (drop)="onDropPDF($event)">
      <div class="upload-icon">
        <i class="bi bi-file-earmark-pdf"></i>
      </div>
      <p>Haz clic o arrastra archivos PDF aquí para subirlos</p>
      <p class="text-muted">Máximo 5 archivos PDF</p>
      <input #pdfInput type="file" multiple accept="application/pdf" hidden (change)="onPDFSelected($event)">
    </div>

    <div id="pdfPreview" class="mt-3">
      <ul class="list-group">
        <li class="list-group-item d-flex justify-content-between align-items-center"
            *ngFor="let pdf of pdfArchivos; let i = index">
          {{ pdf.name }}
          <button class="btn btn-sm btn-danger" (click)="eliminarPDF(i)">Eliminar</button>
        </li>
      </ul>
    </div>




    <!-- Información de contacto -->
    <div class="form-section">
      <h3 class="section-title">Información de contacto</h3>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Nombre completo</label>
          <input type="text" class="form-control" formControlName="nombreContacto">
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label">Teléfono</label>
          <input type="tel" class="form-control" formControlName="telefonoContacto">
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label">Correo electrónico</label>
        <input type="email" class="form-control" formControlName="correoContacto">
      </div>
    </div>

    <div class="form-navigation">
      <button type="button" (click)="redireccionamiento.redirigirAHomeIngresado()" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Volver al Inicio
      </button>
      <button type="submit" class="btn btn-primary">Publicar Inmueble</button>
    </div>
  </form>
</div>
